{% extends 'base.html' %}
<!-- include crispy -->

{% load crispy_forms_tags %}
{% load static from staticfiles %}
{% block title %}Graph Analysis{% endblock %}


{% block content %}
    <!-- charts static files -->
        <script type="text/javascript" src="{% static 'fusioncharts/fusioncharts.js' %}"></script>
        <script type="text/javascript" src="{% static 'fusioncharts/themes/fusioncharts.theme.candy.js' %}"></script>
        <script type="text/javascript" src="{% static 'fusioncharts/themes/fusioncharts.theme.fint.js' %}"></script>

    <script> var graph_analysis_data = {{ survey_data|safe }} </script>

    <div class="d-flex justify-content-between flex-wrap flex-sm-nowrap align-items-center pb-2 mb-3 border-bottom">
        <h2>
            Results: {{survey.name}}
        </h2>
    </div>


    <div class="container-fluid">
        <div class="row">
            <div class="container-fluid">
                <div class = "row text-center">
                    <!-- JS magic tables -->
                    <div class = "single_term_table col col-md-8 card card-body bg-light outside-container" style="margin:24px" id="termtables">
                        <!-- CHARTS START HERE -->
                        {% for name, json_data in charts %}
                            <div class="d-flex justify-content-between flex-wrap flex-sm-nowrap align-items-center pb-2 mb-3 border-bottom">
                                <div class="text-xs-center p-4 bg-info rounded">
                                    <div class="row">
                                        <div class="col-sm">
                                            <div id="{{ name }}" style="L">
                                                {% autoescape off %}
                                                    <script>
                                                        create_chart('{{ name }}', {{ json_data }});
                                                    </script>
                                                {% endautoescape %}
                                            </div>
                                            <br>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm">
                                            <div class="container alert alert-info survey-description"  role="alert">
                                                <span style="font-size:xx-large">{{ name }}:</span>
                                                <p>My name ğŸ“› is, my ğŸ“›name ğŸ“› is My nameğŸ“› is, Charles the Second! â€‹ I ğŸ’loveğŸ’ the peopleğŸ‘¦ And the peopleğŸ‘¤ â¤ï¸loveâ¤ï¸ me So much that they restored The English monarchy! â€‹ Iâ€™m partã€½ï¸ Scottish, French, Italian A little bit Dane But one1ï¸âƒ£ hundredğŸ’¯ğŸ’¯ percent ğŸ”£ partyğŸº animalğŸ€ Champagne? â€‹ Spaniels I adored Named after me too Like me, they were ğŸ¢fun ğŸ¢ With ağŸ…°ï¸ nutty hairğŸ’ˆ do! â€‹ Is today my birthdayğŸŠğŸŠ? I canâ€™t recall Letâ€™s have ğŸˆ¶ ğŸ…°ï¸ağŸ…°ï¸ ğŸ‰partyğŸ‰ anyway Because I loveğŸ’˜ ğŸ…°ï¸ağŸ…°ï¸ masked ğŸ˜· ballğŸ³! â€‹ All hail, the kingğŸ‘‘! Of bling! Letâ€™s sing! Bells ringğŸ”—! Ding dingğŸ‡©ğŸ‡ª! Iâ€™m the kingğŸ‘‘ who brought backâ†©ï¸ partyingğŸº! â€‹ King Charles, my daddy Lost his throne and ğŸ‘‘kingsğŸ‘‘ were banned They chopped offğŸ“´ his headğŸ’† Then Olly Cromwell ğŸ”¨ruledğŸ”¨ the land â€‹ Old Olly wasnâ€™t jolly </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br>
                        {% endfor %}

                    </div>
                    <!-- Right Sidebar -->
                    <div class = "col col-md-auto card card-body bg-dark text-white" style="margin:24px 0px 24px 0px">

                        <p class="lead">Add new term</p>
                        <div class="btn-group-vertical" role="group" aria-label="Basic example" style="margin-bottom:24px">
                            <select class="custom-select" id="addtermform">
                                <option selected hidden disabled>Please select a classification</option>
                                {% for classif in classifications %}
                                    <option value="{{classif.pk}}">{{classif.name}}</option>
                                {% endfor %}
                            </select>
                            <button type="button" class="btn btn-info" id="addterm" >Add</button>
                        </div>

                        <p class="lead">Remove field</p>
                        <div class="btn-group-vertical" role="group" aria-label="Basic example" style="margin-bottom:24px">
                            <select class="custom-select" id="remtermform">
                            </select>
                            <button type="button" class="btn btn-secondary" id="remterm">Remove</button>
                        </div>

                        <p class="lead">Analysis Controls</p>
                        <div class="btn-group-vertical" role="group" aria-label="Basic example" style="margin-bottom:24px">
                            <button type="button" class="btn btn-warning" id="deltermpage" style="margin-bottom:24px">Clear all</button>

                            {% if operation == "overwrite" %}
                                <button type="submit" onclick="return confirm('Are you sure you want to delete analysis `{{ analysis_name }}`?')" class="btn btn-danger" name="delete" value="{{ analysis_pk }}" id="delanalysis" style="margin-bottom:24px">Delete analysis</button>
                            {% endif %}

                            <button type="submit" name="operation" value="{{operation}}"id="post_save_analysis" class="btn btn-success">Save Analysis</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>



{% endblock %}